<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zheyu Li" />

<meta name="date" content="2023-12-04" />

<title>Homework of SA23204189</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of SA23204189</h1>
<h4 class="author">Zheyu Li</h4>
<h4 class="date">2023-12-04</h4>



<div id="hw0-2023-09-11" class="section level1">
<h1>HW0 2023-09-11</h1>
</div>
<div id="question1" class="section level1">
<h1>Question1</h1>
<div id="对不同种类的哺乳动物的脑重和体重进行回归分析" class="section level2">
<h2>对不同种类的哺乳动物的脑重和体重进行回归分析</h2>
</div>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div id="准备工作" class="section level2">
<h2>准备工作</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(alr4)</span></code></pre></div>
<pre><code>## Loading required package: car</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## Loading required package: effects</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">str</span>(brains)<span class="co">#查看数据集brains的数据类型、变量名称和观测值</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    62 obs. of  2 variables:
##  $ BrainWt: num  44.5 15.5 8.1 423 119.5 ...
##  $ BodyWt : num  3.38 0.48 1.35 464.98 36.33 ...</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(brains)<span class="co">#显示脑重、体重的均值、分位数</span></span></code></pre></div>
<pre><code>##     BrainWt            BodyWt        
##  Min.   :   0.14   Min.   :   0.005  
##  1st Qu.:   4.25   1st Qu.:   0.600  
##  Median :  17.25   Median :   3.342  
##  Mean   : 283.13   Mean   : 198.794  
##  3rd Qu.: 166.00   3rd Qu.:  48.201  
##  Max.   :5711.86   Max.   :6654.180</code></pre>
</div>
<div id="回归模型的调用" class="section level2">
<h2>回归模型的调用</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log10</span>(BrainWt)<span class="sc">~</span><span class="fu">log10</span>(BodyWt),<span class="at">data=</span>brains)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log10(BrainWt) ~ log10(BodyWt), data = brains)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.74503 -0.21380 -0.02676  0.18934  0.84615 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.92713    0.04171   22.23   &lt;2e-16 ***
## log10(BodyWt)  0.75169    0.02846   26.41   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3015 on 60 degrees of freedom
## Multiple R-squared:  0.9208, Adjusted R-squared:  0.9195 
## F-statistic: 697.4 on 1 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="数据散点图和拟合曲线的绘制" class="section level2">
<h2>数据散点图和拟合曲线的绘制</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>brains,<span class="fu">aes</span>(<span class="at">y=</span>BrainWt,<span class="at">x=</span>BodyWt))<span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span><span class="fu">scale_y_log10</span>()<span class="sc">+</span>                                   <span class="co">#将坐标尺度修改为每格10倍</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span>                                           <span class="co">#画点</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span>lm,<span class="at">formula=</span>y<span class="sc">~</span>x,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span>                   <span class="co">#画回归直线</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;脑重&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;体重&quot;</span>)<span class="sc">+</span>                                         <span class="co">#修改坐标名称</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;哺乳动物脑重和体重的拟合图像&quot;</span>)<span class="sc">+</span>                           <span class="co">#加标题</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">label=</span><span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span><span class="sc">==</span><span class="fl">0.9208</span>),<span class="at">x=</span><span class="dv">1000</span>,<span class="at">y=</span><span class="dv">50</span>)<span class="sc">+</span>        <span class="co">#加图例</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">label=</span><span class="fu">expression</span>(log[<span class="dv">10</span>](y)<span class="sc">==</span><span class="fl">0.92713+0.75169</span><span class="sc">%.%</span>log[<span class="dv">10</span>](x)),<span class="at">x=</span><span class="dv">500</span>,<span class="at">y=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;expression&#39;

## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;expression&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="用回归模型做预测" class="section level2">
<h2>用回归模型做预测</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>BodyWt_min<span class="ot">&lt;-</span><span class="fu">min</span>(brains<span class="sc">$</span>BodyWt)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>BodyWt_max<span class="ot">&lt;-</span><span class="fu">max</span>(brains<span class="sc">$</span>BodyWt)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>predicted<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">BodyWt=</span><span class="fu">seq</span>(BodyWt_min,BodyWt_max,<span class="at">length.out=</span><span class="dv">100</span>)) <span class="co">#创建需要预测的自变量数值</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>predicted<span class="sc">$</span>BrainWt <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">predict</span>(model,predicted)) <span class="co">#预测数值</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">head</span>(predicted)</span></code></pre></div>
<pre><code>##      BodyWt     BrainWt
## 1   0.00500   0.1575703
## 2  67.21889 199.9064035
## 3 134.43278 336.5849110
## 4 201.64667 456.5159502
## 5 268.86056 566.7201444
## 6 336.07444 670.2137763</code></pre>
</div>
<div id="模型检验" class="section level2">
<h2>模型检验</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYcR206AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZrY6kJA6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmZmZmkJBmtrZmtv9/f3+QOgCQOjqQOmaQZgCQkDqQkGaQtpCQtv+Q27aQ2/+2ZgC2Zjq2tma225C2/7a2///bkDrbtmbb25Db/7bb/9vb////tmb/25D//7b//9v///9pQQvZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARcElEQVR4nO1dDXvbthGGXc9ztjatnGbdukhut3SVsixcV1MS//8fG+4DXxKJI0GQomy8T+RIFAiArw6Hwx0+VFMQhbp0BZaOQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpCAQpAAR9DhcdVUSt09X7A2C4QjaHf3vH+4b3b3F6zNAmEJOjyum1rp1+2XS9ZncQgI2mlyqkJQAK+J3R8e754Pj6WJBfCVtLrZHp8KPyEu0c3XSunfouvC8UkhVi13gh7gW4IMTr/NiPkJOj6Blts/rDousBBDhxHBCyaIe4H9w7r9AhMkNPaZCdL6x2LiXgzsUYQxuE4vGGZ2YLJW3Nb2D/rNminQF28+3mzxA/7Z4Zf4nhPmw+wStH/DP70xuE4v+BJUaTmBtofSpRsd0aHT1cojaMcp9XuTMF99ZyfItg3z5vQCE1ShwID0aOIMmSQj8Pg7R9Dh3ZYaqH6f38wNuvk5mlgPgqgea3NFP/vhkWqF5j6+rf0mhv0gEmQS5kMwFqvuPd05Efo1MRgVUvdPXCFrpIOqM4K0Trr9TBJkEuaDN9RYNbXWi9XEw3mnk/UPAirYvwD/UROrQTeHXRW3qjMJwt+Um5hJmK++wVhs/6cv+JoUIAHHp7vfrCF0coF10I60rncjtiCjgyogaIXEIGO1cgRl7e4tQcenVQPqbnKCsBfSLcFJaniBCYKBIfZNQBWKkhEauFjjsOjuWd+2JuHREgdKmhPmq63TQfBD7laTN7HGqhanToMLxg6qoJFVfJkHI4EdhN3KB9JBN1vTAE+HMWPhdfPanNBFzuft+HT6HGcXloDikxZQCBLg9WLzjMWuDacSVFzSJzhrYiWqEeKMoCJCIc4IGhfVUFeDVIJGRjWuplMcTpDpxcYZ0i+YoJnLvTQKQQIGEpTNaf9SCQKgi2qsq+AFE2S9DKO09AsmyLjhxhmKFyGIfHzDPH0pEkQez12KBA23v3JiEEFcxyQdxL7egdXryG5GWILYp3786aNSqxpjshBpXTf7t//gWIfyXr3gJcSubKTDdRkEPd1j3Ei/ZS87RGchZMP1U6/MDsJ4PNgnVoK2Dbww5Kp/+O+/2HDNKyXorIl5BO085gpBZwRxtM8F/BJ10OFxlcflelmCQGSqW58gZObN1ouIpvdiWXDhbr5S6rvvgyamr3z1fn0eMt70zXwRBJGWvR0d9wZW+mGTIEFZliIkEoS86EHOJASdma8gPQkEZVmKMIYgVKZ/5cl0JuDMYgWv2ganPUOQUrIhqAmCgD1d24F9+NyikjeDKpp5KcJYCWKDDuYI3IMBA/8xQfypoXE1G4KQsrb3aYL0Z767XsE/17ETjO5JI2j8UoQxOkgTY7jQ2lXzwYaed5Hgd+OaNdNZQf/+ZxAqvvuHZwj2hwRZ3ZzSxHIsRUiXIHREGS7A5MD5m/iXmxh9agKC4Lp+a8cY3/3w3PDdx59+/eH5TIIGVzTzUoQRTaxy6gbkglGT5mbtjeOpmARtq1Vj7q5+XJkqYbU2ftc+kR0E03VwUNzVEEcQhJqFuSDNAnToF5t//KkJCDI6yBIE1+manfzY6oSZhiCajAwyNgFBMCHaEITSzOOohs0/8ykkiHsxN8agFgp3H3/26nhqGCa6O+6ed21rSBjkU4OONDNB08CXnDPDOcVhdrOtQEl3M2Rnkd49nxB0WY9iO0CKqDptw4o0l2sVkY3GeWV1h7d8CXK9V+uwK80OAoJihqKhpXsq40IIsrKsugal6RIUddpXyixZWjRBbnTROWhP1kHVuHn8iyDIta7u6iQ77UfOMV4SQZuYT+NVOcxO0TG6aEnTO7PG66JG4dIEWWND8oilh57H4cIEQbgCX6LHMEVJ55i9eVmCKJyju3a5GikSdLVRDVO2IoI2farx+pQ00KP/bYwcScl75zuqVlNnN6BgpAVaV7+w6SsjiIcWquk9Yn5VBCEnunVt1ATPff0EGd3MXXzfu7InvEh2fUpE3dxsmmHeqIEEXe80YGpd2jAc6KxLMRRHTAO+lEeR+vYNS9GgOwcnvMZpwGz6qPbARfzWwQmvbhowCSxJz/Bi00fzSdOAh5c7GtSiNx1hL/n24QmvaBowqztlxhcpWSQkvJppwEzPJrV5YR7ZE14ku44ylOEovdt8wQSx+CgiKjmXhIRi6Dlnuekl0LhrrNmVHPaJhZ5zlptcAPp8RrUuymdwwh6h55zlpuZvh10jS0ozFKXQc8ZyE7PHUHKOEU26BC3ZUFTkj88x4kvWQUsOPSvTw2fJa3jCpYeeyWOYyWMwkR1kNoHs1FNTERQMLrJkmD0hoDKbPNetuz0Pza4feFRqGcqU6+CEZoJ0pBfzwvddXqPcBBk/HA+78nnkkiKrtMVlN0Fe+L6eZY6i8qVnxMi0LevBCQ+PHx5xl8bFSJChZKMcQfkyH5xQi4dWwav4HEVjA8yhg0LpyS2fiS7XSt39N2ZJi5sMZfyJFQ+7JuEn2Se9f1hG2Icb1DTkYAGDE7IGHrljdRYj1+jm0T6NWCHZE86UnfUUmv9z1KqtnOwJ58nOUrOZTHa4oGEJl7Ju3mietGDgoJKyJ5wlO+66JtQ9tqTsCefITplQ+9T0XOHsDqt7mhnEp5l9dsfwck/v4yjp4Gksqbiy2R0ujpxzvBUtcXDCi87u8OYYzjT94VpmdwRjiTl0jy14eMJLzO4wYfZGzdG1hyUPTzj/7A4rN80sXXtQdPaE8VyGDLrD0RYvzZlN+ZhKDE4423oxRS/us3gO5hUQNM96MWWXDBBLTe5oRV+kKOkZ1otx3NgRtBnSNnMiKaox7VBDWekxBF1AcFxtsiccm50y3xrhIY9h3uL7Y3EEWW78Xixv2YOQQFCWQyDbylVujZsVo/77GE6EBIKyHALZUq5RPPjeiM2l+UlS0jkOgTwv14iOE57Ls9Ok2kHjD4HsJsj5mJfAT6IlPf4QyAhBhEWw0yTpoD6HQKZs8qaaBfKT1M3Lh0CmbfJ22f68A5PYQSM3edssRnyaiQjq3uQtKbuLYpKwz5hN3pYkPYBpwj7pm7wtjZ+pwj5dm7zFPYqLY6dZVthnifxMGvaJOWfPyl0kO820YZ8hBC2Vn0nDPj0J2q2Z9NpsUT39Ufb9MaXDTCSIdHX1xw3teV2Z5IUgN/DSr/3b5+NPv8CfLR1ihcYB7//8zXvsC+jT4ft/4iqj4CyE8EgE/yCELEggSFzJ0zM74xHDffd///kL797PJ+zQiQXGLUd7h8Ne+vWt2YecTz8Ij0TwD0LIghSPYqawD+a4UQ3sxf+t1kT6D4AOseITC/g5eUd6sDB0avOJD70KjkQ4ORErS0UHJhy53Nllp8zJJ9W6Wjf1ClWQOcSKF+0xQXymAR1zteZP5vSD4EiERRCUK7JqToap7z/pB/z207Zxh1jxiQUnEvRu60kQfEGb+4fb+V+aoLEHRnB23qrkw1/ePuun+oY1LR1i5U4xABgddG/OY3FnIYRHIiyAIDYUR8I3DIlyPCuIDrGCERydWGAI4l7s3d/8XoxPPwiORFgAQZlCz1eDwQRNB6kIJYmFmMHYGkx1b6YiRj/fTARlCT3Hi0j7fikEZQk9x4tI+34hBOUJPUeLSPx+MQTlCD1Hi0j8fiEE5Qk9R4tI/H4hBPUKPY8sIu37pRDUI/Q8uoik7xdDUEEbnJJmczbLbOAXhDOCxm3y9vLABO3cKC6X1/eF4EyCCkIUJS3AEASnJUOkZeQmby8PTBCOUcGnOMFg9bphlDR6R9HTmcM1/YJgZpitjA+52EEhDEFrExkrBIXwCCL1k3+wet3wdBBODcoTHntBYILqmy1MIcgUoQ+AkyLi5nnMByWbHnEPVo/iozB2UI1zp/YP2RvY8Uk/X6VichnbNw1m3cY3XInvutaj+Dgmt6RZs0Ueoo5EUmguUsz0iN3dq3gBMw01IkJQq1V3zyk+X/TuPsVLmImguGqLEPRmG/0+fnfP4qOYh6DOrU356876008fFwCZIKH4KGYhqBaU5MQEScVHMQdB4g84bRMbIz/TElSRBVJ1VbAyFsoIJR29m0tZ9lEqTY9zFrofUe7mJYJGHvMwhx0k/4CRR5QNxThBfYqPYnKCKgoFJKvZShxqRAnqU3wUxSctoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkoBAkYDqC3HYy/+m7d1O9bt/nyV2s5Tg7Z5Jnw6ipJYjmP/Wta2c68wVtIRufsGHSvkqCeCJVdMnWdRL09wfaC9/NKaM3h3cfYZYzXYbNFu/+92jS4QIthffZg7rtftZm+c3aS/NBt+m1zYSPh6fy4GriRKp5CILZ7vzipY1r3Byflj+Yy1Z10N75K7uChAmi3BqcEWQJcmmoAJMJvEzGdrlgAuYhaIXtwq63ool1uD5k5S3Dcs9GkoLrjOHhmCA706wmHuC6l8YUYgmyGY9Z4jWbDtJ/6AH1Q5AS4adp7GXzbL6OqZWKEhSmQVYsQV7GS51IfkIQ9/tMED9NYy9bgkxT0irk9rOToNYmFqQ5IchkTEt+lqyDfAlqTDcUShCn8yUI//eamFPSsPci5RmmaZMgg13aPMU5CbI9r6eD1l6HfKqDatoU2Bl90M0fn+5+Q4VOKidMExIU9vSJ/f6cBNGaRvglXS9md0Hfkcq2vdjx6Z4EQ63cs+2QIVjZBsef6HfrMA1rZr8Xg4xRlBJX/MxKENolqC+NHURPbi7vTuwgnAK8Y0FD1HanPhjJfCAd5NJgv39iB/He1Kkzga9zsPppvv0hrpOgGVEIElAIElAIElAIElAIEtCPoHMr9Pi07jRNeSsEu2eCTsubpJ3bIn4mdKwQrRCELTLAedq6cViWkj3Lsatg+JNKUHXfWU0eO7ulcDqtqUPUWiOH4e5HSKoNYhqotW0FkadkR1BnwfpPIkERtzhvheAWU5LfD6sZP5sCB56Hd7+A+a1tcLwPZECuTlLJjqDOgvWf3gTtH8CludqT87RGY39txwzo+bz5iMMs2grBLcfFj6aaa+Nm9byp7C2lh6jvfoeqVbefH3A7kbbtehJL9u6p6B46keC+u+DqbgBBuEsIeJDh8fj3MaNOHEbW3NKpmnZBN23/RYKOt+EuM5431bpk8eI9/mfczq1jzMSSz++pcfC77i64vhlA0IojLsZ5qi9avwX9ajuvmnZLABJu3slSV5bu9b2pxnUBTR6qy/9RPdk5BC4v2J7mX1ydlJLP7zHuuc6CdYPpT9DaubACd5V1y5hf+7Saa/s7wh4IVoFYT6kdiEP7hy2t32yh1pSQlUdN8Qtqb4klt9yj5QWaUmfBh8c0gkirPTrfaXVWTSvo/HPRo+3YWRp4Si1B+uer8ZfG/wKCWqszsOSWe3SqHe5v11FwKkE9JMiqSv93tJ8DT6nzF+1WFZ3mUpk+KE7QsJJb7jm8+xUtra6C0wlq1UGVV03b2bIm4N+RvcmBp9QRVP8Be/X6q/fWFdsWRk0sueWe49PX1AI7Ck7VQT16MWeueX2JdR4HnlJH0P7rNxSpoaN+uk7GTSzZ3VOhVQBJeGeProIH9WI+Qa120O2/KfzEcTqzZ0LNRxmxwW91kPWUOoLwoG373663HdSv5HM7yIaSugruawe1V/EM7RHMxHDCoJuTS96/7djVzvxqqaP5KtyQhbu19oHESdpBaB2LZSy5ar9x6FjsHKdjpFp1xy5bx1P90GMb8DEld2+LOHA0/4pRCBLwf5dncglCQgGyAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question2" class="section level1">
<h1>Question2</h1>
<div id="生成标准柯西分布的随机样本" class="section level2">
<h2>生成标准柯西分布的随机样本</h2>
</div>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<p>柯西分布的概率密度函数为 <span class="math display">\[f(x)=\frac{1}{\pi}\frac{1}{1+x^2},
x\in\mathbb{R}\]</span></p>
<p>柯西分布的累积分布函数为 <span class="math display">\[F(x)=\frac{1}{\pi}\bigg(\arctan
x+\frac{\pi}{2}\bigg), x\in\mathbb{R}\]</span></p>
<p>柯西分布累积分布函数的逆函数为 <span class="math display">\[F^{-1}(x)=\tan(\pi x-\frac{\pi}{2}),
x\in[0,1]\]</span></p>
<div id="标准柯西变量的生成" class="section level2">
<h2>标准柯西变量的生成</h2>
<p>这里运用了<span class="math inline">\(X\sim F(x)\)</span>,则<span class="math inline">\(F^{-1}(X)\sim
U(0,1)\)</span>这个原理来生成随机变量</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>)      <span class="co">#生成1000个标准柯西变量</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">tan</span>(pi<span class="sc">*</span>u<span class="sc">-</span>pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">head</span>(x)             <span class="co">#显示头几个柯西变量的值</span></span></code></pre></div>
<pre><code>## [1]  0.27238744 -3.30636055 -0.01185434 -1.79726271  0.27510713 -1.74233660</code></pre>
</div>
<div id="画出柯西变量的样本直方图" class="section level2">
<h2>画出柯西变量的样本直方图</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">hist</span>(x[<span class="sc">-</span><span class="dv">10</span><span class="sc">&lt;</span>x<span class="sc">&amp;</span>x<span class="sc">&lt;</span><span class="dv">10</span>],<span class="at">prob=</span>T,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.35</span>),<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">main=</span><span class="st">&quot;样本直方图与密度函数对比图&quot;</span>,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span>pi<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">add=</span>T,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1-2023-09-18" class="section level1">
<h1>HW1 2023-09-18</h1>
</div>
<div id="question1-1" class="section level1">
<h1>Question1</h1>
<p>利用逆变换法复现函数sample的部分功能(replace=True)</p>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div id="编写函数" class="section level2">
<h2>编写函数</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(x,size,<span class="at">prob=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x),<span class="fu">length</span>(x))){  </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="co">#x代表样本空间，size代表样本大小，prob代表概率(缺省值情况下为等概率)</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(x)<span class="sc">==</span><span class="fu">length</span>(prob))</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="co">#x的长度应当和prob的长度相等</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  </span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  cp<span class="ot">&lt;-</span><span class="fu">cumsum</span>(prob)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(size)              <span class="co">#生成均匀分布样本</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  R<span class="ot">&lt;-</span>x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]  <span class="co">#生成所求样本</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="fu">return</span>(R)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="用sample函数生成随机变量" class="section level2">
<h2>用sample函数生成随机变量</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="st">&quot;a&quot;</span>,<span class="cn">TRUE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">sample</span>(x,<span class="dv">30</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;TRUE&quot; &quot;TRUE&quot; &quot;a&quot;    &quot;1&quot;    &quot;TRUE&quot; &quot;2&quot;    &quot;1&quot;    &quot;a&quot;    &quot;a&quot;    &quot;TRUE&quot;
## [11] &quot;TRUE&quot; &quot;TRUE&quot; &quot;a&quot;    &quot;TRUE&quot; &quot;2&quot;    &quot;a&quot;    &quot;2&quot;    &quot;1&quot;    &quot;TRUE&quot; &quot;2&quot;   
## [21] &quot;1&quot;    &quot;TRUE&quot; &quot;a&quot;    &quot;TRUE&quot; &quot;TRUE&quot; &quot;TRUE&quot; &quot;TRUE&quot; &quot;TRUE&quot; &quot;2&quot;    &quot;TRUE&quot;</code></pre>
</div>
<div id="用my.sample函数生成随机变量" class="section level2">
<h2>用my.sample函数生成随机变量</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">my.sample</span>(x,<span class="dv">30</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;2&quot;    &quot;TRUE&quot; &quot;a&quot;    &quot;2&quot;    &quot;TRUE&quot; &quot;TRUE&quot; &quot;2&quot;    &quot;TRUE&quot; &quot;a&quot;    &quot;a&quot;   
## [11] &quot;a&quot;    &quot;2&quot;    &quot;TRUE&quot; &quot;2&quot;    &quot;a&quot;    &quot;TRUE&quot; &quot;TRUE&quot; &quot;2&quot;    &quot;a&quot;    &quot;1&quot;   
## [21] &quot;TRUE&quot; &quot;a&quot;    &quot;TRUE&quot; &quot;2&quot;    &quot;a&quot;    &quot;a&quot;    &quot;2&quot;    &quot;a&quot;    &quot;TRUE&quot; &quot;2&quot;</code></pre>
</div>
</div>
<div id="question2-1" class="section level1">
<h1>Question2</h1>
<p>3.2 标准拉普拉斯分布具有密度</p>
<p><span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},
x\in\mathbb{R}.\]</span></p>
<p>使用逆变换法生成一个大小为1000，服从拉普怕死分布的随机样本.使用本章中给出的一种方法来比较生成样本和目标分布.</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<p>拉普拉斯分布的累积分布函数为</p>
<p><span class="math display">\[
F(x)=\begin{cases}
\frac{1}{2}e^x,\ x&lt;0 \\
1-\frac{1}{2}e^{-x},\ x\geqslant0
\end{cases}
\]</span></p>
</div>
<div id="hw2-2023-09-25" class="section level1">
<h1>HW2 2023-09-25</h1>
</div>
<div id="question-1" class="section level1">
<h1>Question 1</h1>
<p>Proof that what value ρ =l/d should take to minimize the asymptotic
variance of <span class="math inline">\(\hat π\)</span>? (m ∼ B(n, p),
using δ method)</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
</div>
<div id="question-2" class="section level1">
<h1>Question 2</h1>
<p>Take three different values of ρ (0 ≤ ρ ≤ 1, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span> , Number of repeated simulations K =
100)</p>
<div id="编写函数-1" class="section level2">
<h2>编写函数</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>pi_est<span class="ot">&lt;-</span><span class="cf">function</span>(rho,n,K){   <span class="co">#rho=l/d,n为针数，K为重复模拟的次数</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  l<span class="ot">&lt;-</span>rho</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  pi_hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(K)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  </span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)  <span class="co">#针心到平行线的最近距离</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>) <span class="co">#针与平行线的夹角</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  pi_hat[i]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(<span class="fl">0.5</span><span class="sc">*</span>l<span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  }</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  </span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  pi_hat</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="带值计算" class="section level2">
<h2>带值计算</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>pi_hat1<span class="ot">&lt;-</span><span class="fu">pi_est</span>(<span class="fl">0.5</span>,n,K)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>pi_hat2<span class="ot">&lt;-</span><span class="fu">pi_est</span>(<span class="fl">0.8</span>,n,K)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>pi_hat3<span class="ot">&lt;-</span><span class="fu">pi_est</span>(<span class="dv">1</span>,n,K)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;rho=0.5时的pi估计值为&quot;</span>,<span class="fu">mean</span>(pi_hat1),<span class="st">&quot;方差为&quot;</span>,<span class="fu">var</span>(pi_hat1)),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;rho=0.5时的pi估计值为 3.1405166332758 方差为 2.91869475026967e-05&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;rho=0.8时的pi估计值为&quot;</span>,<span class="fu">mean</span>(pi_hat2),<span class="st">&quot;方差为&quot;</span>,<span class="fu">var</span>(pi_hat2)),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;rho=0.8时的pi估计值为 3.14203287598114 方差为 7.60691022700376e-06&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;rho=1时的pi估计值为&quot;</span>,<span class="fu">mean</span>(pi_hat3),<span class="st">&quot;方差为&quot;</span>,<span class="fu">var</span>(pi_hat3)),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;rho=1时的pi估计值为 3.14120711467485 方差为 6.91280306535536e-06&quot;</code></pre>
<p>从结果中可以看到，随着rho的增大，pi估计值的误差和方差都越来越小</p>
</div>
</div>
<div id="question-3" class="section level1">
<h1>Question 3</h1>
<p>书上练习5.6</p>
</div>
<div id="question-4" class="section level1">
<h1>Question 4</h1>
<p>书上练习5.7</p>
<div id="通过模拟计算两方法估计值的均值和方差" class="section level2">
<h2>通过模拟计算两方法估计值的均值和方差</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10000</span>  <span class="co">#每次取10000个数估计积分值</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">100</span>    <span class="co">#将积分值估计100次</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>Y1<span class="ot">&lt;-</span><span class="fu">numeric</span>(M)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>Y2<span class="ot">&lt;-</span><span class="fu">numeric</span>(M)</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#简单蒙特卡罗方法</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">exp</span>(X)</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>Y1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(y1)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#对偶变量法</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">exp</span>(X[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>]),<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>X[<span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span><span class="dv">2</span>]))</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>Y2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(y2)</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="结果显示" class="section level2">
<h2>结果显示</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">mean</span>(Y1) <span class="co">#简单蒙特卡罗方法估计量均值</span></span></code></pre></div>
<pre><code>## [1] 1.718043</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">var</span>(Y1)  <span class="co">#简单蒙特卡罗方法估计量方差</span></span></code></pre></div>
<pre><code>## [1] 2.271879e-05</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">mean</span>(Y2) <span class="co">#对偶变量法估计量均值</span></span></code></pre></div>
<pre><code>## [1] 1.718438</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">var</span>(Y2)  <span class="co">#对偶变量法估计量方差</span></span></code></pre></div>
<pre><code>## [1] 8.108331e-07</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;该实验中，对偶变量法将方差缩减了&quot;</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(Y2)<span class="sc">/</span><span class="fu">var</span>(Y1)),<span class="dv">2</span>),<span class="st">&quot;%&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;该实验中，对偶变量法将方差缩减了96.43%&quot;</code></pre>
</div>
</div>
<div id="hw3-2023-10-09" class="section level1">
<h1>HW3 2023-10-09</h1>
</div>
<div id="question-1-1" class="section level1">
<h1>Question 1</h1>
<p>作业证明题</p>
</div>
<div id="question-2-1" class="section level1">
<h1>Question 2</h1>
<p>习题5.13</p>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞)
and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\ x&gt;1 \]</span> Which of your
two importance functions should produce the smaller variance in
estimating <span class="math display">\[ \int_1^{+\infty}
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2} dx \]</span></p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>) </span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co">#构造f1</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>)) <span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>}</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a><span class="co">#生成m个服从f1的随机变量</span></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>item<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a><span class="cf">while</span>(item<span class="sc">&lt;=</span>m){</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  x[item]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  <span class="cf">if</span>(x[item]<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>    item<span class="ot">&lt;-</span>item<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>}</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>est[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>sd[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a><span class="co">#构造f2</span></span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>}</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a><span class="co">#生成m个服从f2的随机变量(这里运用了逆函数法)</span></span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a>est[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>sd[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a><span class="co">#估计值的均值</span></span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a>est</span></code></pre></div>
<pre><code>## [1] 0.4007810 0.4004671</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co">#估计值的标准差</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>sd</span></code></pre></div>
<pre><code>## [1] 0.2620246 0.3056350</code></pre>
<p>重要函数f1产生的方差更小,从下面的两张图中也可以看到，g与f1的比值更接近于一个常数</p>
</div>
<div id="question-3-1" class="section level1">
<h1>Question 3</h1>
<p>习题5.14</p>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{+\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2} dx \]</span> by
importance sampling.</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<p>由5.13知该积分的蒙特卡罗估计为0.4008</p>
<p>下面画出重要函数和原函数的比较图：</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>    w<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>    gs<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>    <span class="co">#for color change lty to col</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>    <span class="co">#figure (a)</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>    <span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">lwd =</span> w, <span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>    <span class="fu">lines</span>(x, <span class="fu">f1</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>    <span class="fu">lines</span>(x, <span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>    <span class="co">#figure (b)</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>    <span class="fu">plot</span>(x, <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x)), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>    <span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>    <span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA8AAAAEgCAMAAABM0+oCAAAAeFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZpA6kNth0E9mAABmADpmZmZmtttmtv+QOgCQZgCQkGaQ2/+2ZgC2tma22/+2/7a2///bkDrbtpDb2//b/9vb///fU2v/tmb/25D/27b//7b//9v///9+raT+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALGUlEQVR4nO3da5ujtgGGYc0pSdtZt1m366ZL2xlcm///D8vB4zGMsQFJSK/03B86Ta4EmwzPCsTJVABkmdBfAMByBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgDNx2Dz8qArTefjLH1W1f3n8GfpbwRYBZ6IwT2/ngI2p2z1uzWvobwVbBJyHrtbPgLu/qpuGNgLOQ2nqPeg62W6vef9intv//R76e8ESAeehS/cj4H+/NCPwYcM+tDwCzkK9B10PuRe70O3O8459aHkEnIV6sO0F/PB783d3hnlodQSchX27zzyYxKr/sjkwhjICzsI54G7I/d/mdEhMwOoIOAuDgE/pErA+As7CcATeEnAiCDgLw0msbhqaSSx9BJyFL6eR2qGX00j6CDgP3WWT54D/9EdVcTF0Cgg4D+WVw939C4fA8gg4D/Vo++W655I9aH0EnImiPQju2bEHrY+AM3HYDGecuaE/BQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IcB2yAxLy/vwf4VD8BH7fd0kffisWAjpS8d9b/YD8BFx/voyzHXkxJwEjHzXz9DrheAj5uz9kWI6+GJmCk4+bY63RTXyfgw+b8kvdyZCeagCFu6j6zYMCMwEjc+/SDXsGA62Pg0xDMMTBSNGfGSjHgeie6O+QeGX8JGIoWTTNLBrz24gC/lp8nImAgMJvTvNoBF8xCQ5/NNRraAQ+XMvsKMCAMV5dWJRWwr8UBTs04TXQPAQMrc3lhs27ApTEPP9wtDlAkGfDOmNf9n98uL6q0WRzgm7f7iRQD3j29Vbt29OVSSih4d3jQOyAYcDvu7n9pAuZmBijweC+vZMDNFdDH/1SMwIjXSrfgCwb8eflGl7Lt4gDX/O0yDykGXBXd9HNpRuawCBhBrfgAHItNfWfMwz96Z3I4D4yMxfDUqhkPzNnVO7KlIWCg+thpXv9z+5v6jCde7V+a/dcdAQPB8rXY1LszOCUBA2H2nluLN/WCgJGxYI9qHmAEBmbzeGnVTIs39e4YuIgqYO4HxjpiSLezfFNnFhpZiWPEHbI7D/z4z97FyASMREWzyzxkuamXBIwMxBlvw+4YeHAxMgEjIfFWe2H5pl42k0X9i5EJGKmIdp95QPJmhrUXh+xIxNsgYOCDSLSXCBiodHaZhwgYiOfKyNmWb+qFaV/uuf/180QSAUOKZLJ9izf10xmkw+aRgCFIdsztswi4OYVUGkPAEJRGvss39f1Lk25pXksChowkmu0ZbOrDubjxubmPtyIQMCSoTjPf0d/Uh7c53rjtkYChJM18rY+B4wqY+4FxKc1k+5IK2NfiICjRXeYhAkaScoi3QcBIRy7VXiBgJCKTfeYBAkYaMoy3IXgzQ3cRZ/M8gZG3AxNwHrIccYdUA27fDPyxF2C1OGiK59HMQYkGfEqXF3znpneRUdBvEgnRgLvHyg8eirlscVDBiHuFaMCMwPkh32skA24ulnyuvjzVdtniEDGavUcw4Kpt+OFHVZqRfgk4CcxSTaAZ8MqLQwjEO4XdM7GOW2MuhkEChg1G3Pmsnol13NY7skV7OHp9Yb4DLpiFTgcndpewupTy9I7gc0WhR2DuBxbEiV0rg03927fbP8+6Z2K1/7c8vyM4dMC+Fgc/GHHt9Tf1b6dQx35e+LyMcRfNCOxrcfCCfh2wvhvp8mQOAeMmknXO/nbCzzksAsYtzFJ5YBtw72KKNa/E6jALHbnBM06DfpckWQZc9C6GWmkEPm5HbwResjj4wojrn13AhendkLvWLvRx+3z7HyDggM7FEu8KLM8D9y9GXu0YuDQjd/IvWxwcYchdnVXARXcgynlgtMh3fdzMgOUYcYMjYCzGeaHwCBhzEGxkCBjTMeJGh4BxS79Y2o1OngEbTHI+yA39RTDKazeR3g8c7r+2gMtgSTd+Tsr5COPu35j8bzr+IpiGg1w1BJy5XrHEK4eAs8aZXHUEHKt7Tzea+nOAaeW0+D2gJuAZ+uXde7rR9J+XS2XExRwEfMNgqLzx/DGrD/nWBnta6rvThSN1BHyF12CHBkPulw8laNxAwJf6+8aeTNtHJmRMQcDVKkNtb1ZqyUHu9SNm5C7rgNfdR3azNAZmXMoyYN/hfr30wtukMiFnLquAg8xKrYOQM5VHwH7DHQQb9Bzu8FAZiUs7YG+b8yDY6C69YA47F4kGvMqQ62PRjhFy6iK9H3gpP+F+3UdWiPcaQk5NIiOw43C/Bqsy5E7EoXIqxAN2GW7KwY5gQJanGrDbix4jmkYO4kvIBK1CLWA3Q+6Vg9r8qr2COS85KgHbhXs9WJK9h0Pl6Hl7vWg31zz6muCpi1sYbr9QgrXDHna8/AR8fqt4aV6v/xP3FjczXIbYNbCHHR8vAR+352yLp7cli7sbLkNsBBiZw/MScPNm4pNyZCd67jEwQ2zEbj/lCz5FOgITrLDRPW2Cds/XMfBpCF56DEywCSFojzzNQh823Sz0yPgbyRM5EMS9PW66nkHlPDCSNfa87LkPxM8TASNS8x6In2vvvgMuHM1CA312L8AQ+nlt5T8ldj8wcJ27F+Gs/fP2erELDQgjYEBY7DczALgh1psZAEwQ7FJKAA74CHjCzQzOPitWCawDqxADV6vgeAR29lmxSmAdWIUYhAh4ws0M7j4rUgmsA6sQgyAB37+ZweFnxSmBdWAVYhAmYJ3P8iWBdWAVYkDAYSSwDqxCDAg4jATWgVWIAQGHkcA6sAoxIOAwElgHViEGigEDcIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCVgx4/+uCJ1nGpH2s/ZKHgUWkMObhR+gvYW237JlOseieTPXsZFnrBXzYLHkUbUSO23rTLxz9dw+keatkKV9wufChbLHY/+LuN7BawOWNF7Jo2L80z+Qce7GqhMPmtfmDSPrPoHYA0w540VPVR6wVcGleXX7tcPTHL/mAi6e/awdcOPwFrHgMnEbAO/m1KMT/CKp3QMWPgXe/uZtMIeB5lj3SPiKl+jxc834Q7YAPm+br79z8Ggh4llJ7Dqt13Epv/s1bfbQD7jjKgYDnkB9/W9KH8e0MbgoBd3Oi1gh4hiKJfl1tOmEUp9dvCq9Cx9G5JAKerpDfarp05X8R4iOw098CAU+2f9Eff5st/+Itsaq0A652zUQKk1hrO+28KR9A1ptNCnuf6gG7/C1wMwMgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwHkpHn9Wh438C4LxgYDz0rzduxB/uy4uEHBmysd//VX6FeXoIeDc7Mxz6K8Adwg4N6X5HvorwB0Czsxx+7fHn6G/BJwh4MwUT//dMgmdDgLOy2HzvSoZgtNBwHnZPb3Ve9FMYyWDgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCCMgAFhBAwII2BAGAEDwggYEEbAgDACBoQRMCDs/7UIngF+bcudAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="question-4-1" class="section level1">
<h1>Question 4</h1>
<p>习题5.15</p>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span>; k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># 分成5个子区间</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co">#每个区间取的随机数个数</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#实验次数</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  <span class="co">#使用例5.10中的方法</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(M)</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>  fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>  est[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>  </span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a>  <span class="co">#使用分层抽样法</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(r,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k)</span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>    x<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>    fg[((j<span class="dv">-1</span>)<span class="sc">*</span>r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(j<span class="sc">*</span>r)]<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a>  }</span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a>  est[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a>}</span>
<span id="cb50-25"><a href="#cb50-25" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" tabindex="-1"></a><span class="co">#两种方法的均值对比</span></span>
<span id="cb50-27"><a href="#cb50-27" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,mean),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.52471 0.52475</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co">#两种方法的标准差对比</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,sd),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00105 0.00023</code></pre>
<p>和例5.10中的结果相比，例5.13的分层抽样法得到的估计量拥有更小的标准差，所以更好</p>
</div>
<div id="question-5" class="section level1">
<h1>Question 5</h1>
<p>习题6.5</p>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use a Monte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of χ2(2) data with sample size n = 20. Compare your
t-interval results with the simulation results in Example 6.4. (The
t-interval should be more robust to departures from normality than the
interval for variance.)</p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100000</span> <span class="co">#重复实验次数</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>   <span class="co">#每次实验取20个样本</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="dv">2</span>   <span class="co">#自由度为2的卡方分布</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信下限</span></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信上限</span></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,df)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  d1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  d2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>}</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a><span class="fu">mean</span>(d1<span class="sc">&lt;</span>mu0<span class="sc">&amp;</span>d2<span class="sc">&gt;</span>mu0) <span class="co">#mu0落在置信区间的概率</span></span></code></pre></div>
<pre><code>## [1] 0.91926</code></pre>
<p>从结果上来看，均值真实值落在t区间的概率小于0.95，和例6.4相比，造成这个结果的原因是df=2的卡方分布并不是无偏分布</p>
</div>
<div id="question-6" class="section level1">
<h1>Question 6</h1>
<p>习题6.A</p>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level α, when the sampled population is non-normal. The
t-test is robust to mild departures from normality. Discuss the
simulation results for the cases where the sampled population is (i)
χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case,
test H0 : µ = µ0 vs H0 : µ = µ0, where µ0 is the mean of χ2(1),
Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div id="df1的卡方分布" class="section level3">
<h3>1.df=1的卡方分布</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100000</span> <span class="co">#重复实验次数</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>   <span class="co">#每次实验取20个样本</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="dv">1</span>   <span class="co">#自由度为1的卡方分布</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信下限</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信上限</span></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,df)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  d1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  d2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>}</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(d1<span class="sc">&lt;</span>mu0<span class="sc">&amp;</span>d2<span class="sc">&gt;</span>mu0) <span class="co">#mu0落在置信区间外的概率</span></span></code></pre></div>
<pre><code>## [1] 0.10744</code></pre>
</div>
<div id="的均匀分布" class="section level3">
<h3>2.(0,2)的均匀分布</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100000</span> <span class="co">#重复实验次数</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>   <span class="co">#每次实验取20个样本</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信下限</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信上限</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  d1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  d2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>}</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(d1<span class="sc">&lt;</span>mu0<span class="sc">&amp;</span>d2<span class="sc">&gt;</span>mu0) <span class="co">#mu0落在置信区间外的概率</span></span></code></pre></div>
<pre><code>## [1] 0.05206</code></pre>
</div>
<div id="参数为1的指数分布" class="section level3">
<h3>3.参数为1的指数分布</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100000</span> <span class="co">#重复实验次数</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>   <span class="co">#每次实验取20个样本</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>d1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信下限</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>d2<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#置信上限</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  d1[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  d2[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>}</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(d1<span class="sc">&lt;</span>mu0<span class="sc">&amp;</span>d2<span class="sc">&gt;</span>mu0) <span class="co">#mu0落在置信区间外的概率</span></span></code></pre></div>
<pre><code>## [1] 0.08175</code></pre>
</div>
</div>
<div id="hw4-2023-10-16" class="section level1">
<h1>HW4 2023-10-16</h1>
</div>
<div id="question-1-2" class="section level1">
<h1>Question 1</h1>
</div>
<div id="answer-10" class="section level1">
<h1>Answer</h1>
<div id="生成p值并进行排序" class="section level3">
<h3>生成p值并进行排序</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print=</span><span class="dv">3000</span>)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="dv">950</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)                 <span class="co">#生成1000个p值</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>p[<span class="dv">1</span><span class="sc">:</span>m1]<span class="ot">&lt;-</span><span class="fu">runif</span>(m1,<span class="dv">0</span>,<span class="dv">1</span>)        <span class="co">#前950个变量服从(0,1)均匀分布</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>p[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(m2,<span class="fl">0.1</span>,<span class="dv">1</span>)  <span class="co">#后50个变量服从beta(0.1,1)</span></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>p.sorted<span class="ot">&lt;-</span><span class="fu">sort</span>(p)</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>p.ordered<span class="ot">&lt;-</span><span class="fu">order</span>(p)</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a><span class="fu">length</span>(p)</span></code></pre></div>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">head</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.2655087 0.3721239 0.5728534 0.9082078 0.2016819 0.8983897</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">head</span>(p.sorted)</span></code></pre></div>
<pre><code>## [1] 2.551198e-18 4.483793e-18 7.931396e-15 3.099828e-12 5.793331e-12
## [6] 1.550742e-10</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">head</span>(p.ordered)</span></code></pre></div>
<pre><code>## [1]  985  994  987  992 1000  952</code></pre>
</div>
<div id="使用benjamini-hochberg法和bonferroni法进行p值校正" class="section level3">
<h3>使用Benjamini-Hochberg法和bonferroni法进行p值校正</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>p.adj1 <span class="ot">&lt;-</span> p.sorted<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>m)<span class="sc">*</span>m</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>p.adj2 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.sorted,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>p.adj3 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.sorted,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="fu">rbind</span>(p.adj1,p.adj2,p.adj3)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]</span></code></pre></div>
<pre><code>##                [,1]         [,2]         [,3]         [,4]         [,5]
## p.adj1 2.551198e-15 2.241896e-15 2.643799e-12 7.749569e-10 1.158666e-09
## p.adj2 2.241896e-15 2.241896e-15 2.643799e-12 7.749569e-10 1.158666e-09
## p.adj3 2.551198e-15 4.483793e-15 7.931396e-12 3.099828e-09 5.793331e-09
##                [,6]         [,7]         [,8]         [,9]        [,10]
## p.adj1 2.584571e-08 2.383914e-08 2.516892e-08 2.754730e-08 2.983684e-08
## p.adj2 2.383914e-08 2.383914e-08 2.516892e-08 2.754730e-08 2.983684e-08
## p.adj3 1.550742e-07 1.668740e-07 2.013514e-07 2.479257e-07 2.983684e-07
##               [,11]        [,12]        [,13]        [,14]        [,15]
## p.adj1 8.782144e-08 6.020272e-07 6.418532e-06 6.047393e-06 8.736331e-05
## p.adj2 8.782144e-08 6.020272e-07 6.047393e-06 6.047393e-06 8.736331e-05
## p.adj3 9.660359e-07 7.224326e-06 8.344091e-05 8.466350e-05 1.310450e-03
##               [,16]        [,17]      [,18]       [,19]       [,20]      [,21]
## p.adj1 9.414001e-05 0.0003365488 0.00182761 0.001997266 0.002607785 0.01170534
## p.adj2 9.414001e-05 0.0003365488 0.00182761 0.001997266 0.002607785 0.01170534
## p.adj3 1.506240e-03 0.0057213300 0.03289697 0.037948053 0.052155696 0.24581205
##             [,22]      [,23]      [,24]      [,25]      [,26]      [,27]
## p.adj1 0.01520859 0.01642448 0.03011291 0.03093998 0.03651291 0.04869098
## p.adj2 0.01520859 0.01642448 0.03011291 0.03093998 0.03651291 0.04869098
## p.adj3 0.33458906 0.37776297 0.72270993 0.77349961 0.94933571 1.00000000
##             [,28]      [,29]      [,30]      [,31]      [,32]     [,33]
## p.adj1 0.06560208 0.06664947 0.07935846 0.07930634 0.08988302 0.1085257
## p.adj2 0.06560208 0.06664947 0.07930634 0.07930634 0.08988302 0.1085257
## p.adj3 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.0000000
##            [,34]     [,35]     [,36]    [,37]     [,38]     [,39]     [,40]
## p.adj1 0.1401896 0.1947133 0.1995287 0.219688 0.2518893 0.2575544 0.2759018
## p.adj2 0.1401896 0.1947133 0.1995287 0.219688 0.2518893 0.2575544 0.2700046
## p.adj3 1.0000000 1.0000000 1.0000000 1.000000 1.0000000 1.0000000 1.0000000
##            [,41]     [,42]     [,43]     [,44]     [,45]     [,46]     [,47]
## p.adj1 0.2719392 0.2700046 0.2734822 0.2972176 0.2913270 0.2910942 0.3534513
## p.adj2 0.2700046 0.2700046 0.2734822 0.2910942 0.2910942 0.2910942 0.3475480
## p.adj3 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
##           [,48]     [,49]     [,50]
## p.adj1 0.347548 0.3664846 0.4202369
## p.adj2 0.347548 0.3664846 0.4202369
## p.adj3 1.000000 1.0000000 1.0000000</code></pre>
</div>
<div id="生成在alpha0.1下原假设的接受情况" class="section level3">
<h3>生成在alpha=0.1下原假设的接受情况</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>p.refuse2<span class="ot">&lt;-</span>(p.adj2<span class="sc">&gt;</span><span class="fl">0.1</span>) <span class="co">#TRUE为接受原假设，FALSE为拒绝原假设</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>p.refuse3<span class="ot">&lt;-</span>(p.adj3<span class="sc">&gt;</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="生成两种校正法的fwerfdr和tpr" class="section level3">
<h3>生成两种校正法的FWER,FDR和TPR</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">colnames</span>(A)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="fu">rownames</span>(A)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bonf&quot;</span>,<span class="st">&quot;B-H&quot;</span>)</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>A[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(p.refuse3)</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>A[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(p.refuse2)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>A[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse3<span class="sc">==</span><span class="cn">FALSE</span><span class="sc">&amp;</span>p.ordered<span class="sc">&lt;=</span><span class="dv">950</span>))<span class="sc">/</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse3<span class="sc">==</span><span class="cn">FALSE</span>))</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>A[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse2<span class="sc">==</span><span class="cn">FALSE</span><span class="sc">&amp;</span>p.ordered<span class="sc">&lt;=</span><span class="dv">950</span>))<span class="sc">/</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse2<span class="sc">==</span><span class="cn">FALSE</span>))</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>A[<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse3<span class="sc">==</span><span class="cn">FALSE</span><span class="sc">&amp;</span>p.ordered<span class="sc">&gt;</span><span class="dv">950</span>))<span class="sc">/</span>m2</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>A[<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">which</span>(p.refuse2<span class="sc">==</span><span class="cn">FALSE</span><span class="sc">&amp;</span>p.ordered<span class="sc">&gt;</span><span class="dv">950</span>))<span class="sc">/</span>m2</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##       FWER     FDR  TPR
## Bonf 0.020 0.00000 0.40
## B-H  0.032 0.09375 0.58</code></pre>
</div>
</div>
<div id="question-2-2" class="section level1">
<h1>Question 2</h1>
</div>
<div id="answer-11" class="section level1">
<h1>Answer</h1>
<div id="构造函数" class="section level3">
<h3>构造函数</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>bootstrap<span class="ot">&lt;-</span><span class="cf">function</span>(lambda,n,B,m){ <span class="co">#B为每次模拟生成bootstrap变量的个数，m为模拟次数</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>  bias<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)    <span class="co">#bootstrap均值偏差</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  se.boot<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#bootstrap标准差</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  se.samp<span class="ot">&lt;-</span><span class="fu">numeric</span>(m) <span class="co">#样本标准差</span></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  </span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,lambda)</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>    theta<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>    thetastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>      xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>      thetastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>    }</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>    bias[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>    se.boot[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(thetastar)</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>    se.samp[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  }</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>  </span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a>  <span class="fu">data.frame</span>(bias,se.boot,se.samp)</span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="bootstrap算法运行" class="section level3">
<h3>bootstrap算法运行</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>n3<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>bootstrap1<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(lambda,n1,B,m)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>bootstrap2<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(lambda,n2,B,m)</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>bootstrap3<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(lambda,n3,B,m)</span></code></pre></div>
</div>
<div id="bootstrap偏差与理论值的比较" class="section level3">
<h3>bootstrap偏差与理论值的比较</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap1<span class="sc">$</span>bias) <span class="co">#理论值为0.5</span></span></code></pre></div>
<pre><code>## [1] 0.5954229</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap2<span class="sc">$</span>bias) <span class="co">#理论值为0.222</span></span></code></pre></div>
<pre><code>## [1] 0.2211439</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap3<span class="sc">$</span>bias) <span class="co">#理论值为0.105</span></span></code></pre></div>
<pre><code>## [1] 0.1004369</code></pre>
<p>理论值为<span class="math inline">\(\lambda/(n-1)\)</span>，即n=5,10,20时偏差的理论值为0.5,0.222,0.105,与bootstrap实验结果吻合较好</p>
</div>
<div id="bootstrap标准差与理论值的比较" class="section level3">
<h3>bootstrap标准差与理论值的比较</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap1<span class="sc">$</span>se.boot) <span class="co">#理论值为1.443</span></span></code></pre></div>
<pre><code>## [1] 2.20832</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap2<span class="sc">$</span>se.boot) <span class="co">#理论值为0.786</span></span></code></pre></div>
<pre><code>## [1] 0.8265017</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">mean</span>(bootstrap3<span class="sc">$</span>se.boot) <span class="co">#理论值为0.496</span></span></code></pre></div>
<pre><code>## [1] 0.4916441</code></pre>
<p>理论值为<span class="math inline">\(\frac{\lambda
n}{(n-1)\sqrt{n-2}}\)</span>，即n=5,10,20时偏差的理论值为1.443,0.786,0.496,可以看到，随着n的增大，bootstrap标准差与理论值的偏差越来越小</p>
</div>
</div>
<div id="question-3-2" class="section level1">
<h1>Question 3</h1>
<p>Exercises 7.3 (pages 212, Statistical Computing with R).</p>
</div>
<div id="answer-12" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;bootstrap&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     bootstrap</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA))</span></code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cor</span>(law82<span class="sc">$</span>LSAT,law82<span class="sc">$</span>GPA))</span></code></pre></div>
<pre><code>## [1] 0.7599979</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(law)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>thetastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)     <span class="co">#theta的bootstrap估计</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>se.thetastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)  <span class="co">#se.theta的bootstrap估计</span></span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA)</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>se.theta<span class="ot">&lt;-</span><span class="fl">0.115</span></span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a>  <span class="co">#theta的bootstrap估计</span></span>
<span id="cb96-14"><a href="#cb96-14" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-15"><a href="#cb96-15" tabindex="-1"></a>  LSAT<span class="ot">&lt;-</span>law<span class="sc">$</span>LSAT[i]</span>
<span id="cb96-16"><a href="#cb96-16" tabindex="-1"></a>  GPA<span class="ot">&lt;-</span>law<span class="sc">$</span>GPA[i]</span>
<span id="cb96-17"><a href="#cb96-17" tabindex="-1"></a>  thetastar[b]<span class="ot">&lt;-</span><span class="fu">cor</span>(LSAT,GPA)</span>
<span id="cb96-18"><a href="#cb96-18" tabindex="-1"></a>  </span>
<span id="cb96-19"><a href="#cb96-19" tabindex="-1"></a>  <span class="co">#se.theta的bootstrap估计</span></span>
<span id="cb96-20"><a href="#cb96-20" tabindex="-1"></a>  tempstar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb96-21"><a href="#cb96-21" tabindex="-1"></a>  <span class="cf">for</span>(c <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb96-22"><a href="#cb96-22" tabindex="-1"></a>    j<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb96-23"><a href="#cb96-23" tabindex="-1"></a>    tempstar[c]<span class="ot">&lt;-</span><span class="fu">cor</span>(law<span class="sc">$</span>LSAT[j],law<span class="sc">$</span>GPA[j])</span>
<span id="cb96-24"><a href="#cb96-24" tabindex="-1"></a>  }</span>
<span id="cb96-25"><a href="#cb96-25" tabindex="-1"></a>  se.thetastar[b]<span class="ot">&lt;-</span><span class="fu">sd</span>(tempstar)</span>
<span id="cb96-26"><a href="#cb96-26" tabindex="-1"></a>}</span>
<span id="cb96-27"><a href="#cb96-27" tabindex="-1"></a></span>
<span id="cb96-28"><a href="#cb96-28" tabindex="-1"></a>tstar<span class="ot">&lt;-</span><span class="fu">unname</span>(<span class="fu">quantile</span>((thetastar<span class="sc">-</span>theta)<span class="sc">/</span>se.thetastar,<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))  <span class="co">#t的1-alpha/2分位数,alpha=0.05</span></span>
<span id="cb96-29"><a href="#cb96-29" tabindex="-1"></a>d1<span class="ot">&lt;-</span>theta<span class="sc">-</span>tstar<span class="sc">*</span>se.theta  <span class="co">#bootstrap置信下限估计</span></span>
<span id="cb96-30"><a href="#cb96-30" tabindex="-1"></a>d2<span class="ot">&lt;-</span>theta<span class="sc">+</span>tstar<span class="sc">*</span>se.theta  <span class="co">#bootstrap置信上限估计</span></span>
<span id="cb96-31"><a href="#cb96-31" tabindex="-1"></a></span>
<span id="cb96-32"><a href="#cb96-32" tabindex="-1"></a>tstar</span></code></pre></div>
<pre><code>## [1] 1.390486</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>d1</span></code></pre></div>
<pre><code>## [1] 0.6164686</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>d2</span></code></pre></div>
<pre><code>## [1] 0.9362804</code></pre>
<p>即95%的bootstrap置信区间估计为[0.616,0.936]</p>
</div>
<div id="hw5-2023-10-23" class="section level1">
<h1>HW5 2023-10-23</h1>
</div>
<div id="question-1-3" class="section level1">
<h1>Question 1</h1>
<p>课本练习7.5</p>
</div>
<div id="answer-13" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>boot.mean<span class="ot">&lt;-</span><span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>sample<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)   <span class="co">#标准正态法</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>ci.basic<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)  <span class="co">#基本法</span></span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)   <span class="co">#百分位数法</span></span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)    <span class="co">#BCa方法</span></span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>  R<span class="ot">&lt;-</span><span class="fu">sample</span>(sample,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>  de<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>R,<span class="at">statistic=</span>boot.mean,<span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a>  ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb105-18"><a href="#cb105-18" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in norm.inter(t, adj.alpha): extreme order statistics used as endpoints</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm: [&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="st">&#39;,&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]),<span class="st">&#39;]&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="st">&#39;basic: [&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="st">&#39;,&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]),<span class="st">&#39;]&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a><span class="st">&#39;perc: [&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="st">&#39;,&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]),<span class="st">&#39;]&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a><span class="st">&#39;BCa: [&#39;</span>,<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="st">&#39;,&#39;</span>,<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>]),<span class="st">&#39;]&#39;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## norm: [41.86421,173.8304]
## basic: [35.719,165.6823]
## perc: [50.15292,180.1162]
## BCa: [57.13817,202.8508]</code></pre>
<p>从结果中可以看到，BCa方法得出的置信区间比其他三种方法更大，这是因为指数分布为左偏分布，用标准正态法、基本法和百分位数法得出的置信区间都会偏小</p>
</div>
<div id="question-2-3" class="section level1">
<h1>Question 2</h1>
<p>课本练习7.8</p>
</div>
<div id="answer-14" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>cov.hat<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>eigen.hat<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(cov.hat)<span class="sc">$</span>values,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>eigen.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen.hat)</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>  cov.jack<span class="ot">&lt;-</span><span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>  eigen.jack<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">eigen</span>(cov.jack)<span class="sc">$</span>values,<span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a>  theta.jack[i]<span class="ot">&lt;-</span>eigen.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen.jack)</span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a>}</span>
<span id="cb109-14"><a href="#cb109-14" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" tabindex="-1"></a>bias.jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb109-16"><a href="#cb109-16" tabindex="-1"></a>se.jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">sum</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb109-17"><a href="#cb109-17" tabindex="-1"></a><span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack)</span></code></pre></div>
<pre><code>##    original   bias.jack     se.jack 
## 0.619115038 0.001069139 0.049552440</code></pre>
</div>
<div id="question-3-3" class="section level1">
<h1>Question 3</h1>
<p>课本练习7.11</p>
</div>
<div id="answer-15" class="section level1">
<h1>Answer</h1>
<div id="对4种模型进行比较" class="section level3">
<h3>对4种模型进行比较</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:alr4&#39;:
## 
##     ais</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     vif</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(magnetic)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>e1<span class="ot">&lt;-</span>e2<span class="ot">&lt;-</span>e3<span class="ot">&lt;-</span>e4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span>n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)   <span class="co">#每种方法的偏差，用四个矩阵存储</span></span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>yhat1<span class="ot">&lt;-</span>yhat2<span class="ot">&lt;-</span>logyhat3<span class="ot">&lt;-</span>logyhat4<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>col<span class="ot">&lt;-</span><span class="dv">0</span>                                          <span class="co">#将数据输入矩阵的第col列</span></span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>    col<span class="ot">&lt;-</span>col<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>    y<span class="ot">&lt;-</span>magnetic[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>    x<span class="ot">&lt;-</span>chemical[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a>    </span>
<span id="cb115-14"><a href="#cb115-14" tabindex="-1"></a>    <span class="co">#线性</span></span>
<span id="cb115-15"><a href="#cb115-15" tabindex="-1"></a>    J1<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb115-16"><a href="#cb115-16" tabindex="-1"></a>    yhat1[<span class="dv">1</span>]<span class="ot">&lt;-</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[i]</span>
<span id="cb115-17"><a href="#cb115-17" tabindex="-1"></a>    yhat1[<span class="dv">2</span>]<span class="ot">&lt;-</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[j]</span>
<span id="cb115-18"><a href="#cb115-18" tabindex="-1"></a>    e1[<span class="dv">1</span>,col]<span class="ot">&lt;-</span>magnetic[i]<span class="sc">-</span>yhat1[<span class="dv">1</span>]</span>
<span id="cb115-19"><a href="#cb115-19" tabindex="-1"></a>    e1[<span class="dv">2</span>,col]<span class="ot">&lt;-</span>magnetic[j]<span class="sc">-</span>yhat1[<span class="dv">2</span>]</span>
<span id="cb115-20"><a href="#cb115-20" tabindex="-1"></a>    </span>
<span id="cb115-21"><a href="#cb115-21" tabindex="-1"></a>    <span class="co">#二次</span></span>
<span id="cb115-22"><a href="#cb115-22" tabindex="-1"></a>    J2<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb115-23"><a href="#cb115-23" tabindex="-1"></a>    yhat2[<span class="dv">1</span>]<span class="ot">&lt;-</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[i]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-24"><a href="#cb115-24" tabindex="-1"></a>    yhat2[<span class="dv">2</span>]<span class="ot">&lt;-</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[j]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-25"><a href="#cb115-25" tabindex="-1"></a>    e2[<span class="dv">1</span>,col]<span class="ot">&lt;-</span>magnetic[i]<span class="sc">-</span>yhat2[<span class="dv">1</span>]</span>
<span id="cb115-26"><a href="#cb115-26" tabindex="-1"></a>    e2[<span class="dv">2</span>,col]<span class="ot">&lt;-</span>magnetic[j]<span class="sc">-</span>yhat2[<span class="dv">2</span>]</span>
<span id="cb115-27"><a href="#cb115-27" tabindex="-1"></a>    </span>
<span id="cb115-28"><a href="#cb115-28" tabindex="-1"></a>    <span class="co">#指数</span></span>
<span id="cb115-29"><a href="#cb115-29" tabindex="-1"></a>    J3<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb115-30"><a href="#cb115-30" tabindex="-1"></a>    logyhat3[<span class="dv">1</span>]<span class="ot">&lt;-</span>J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[i]</span>
<span id="cb115-31"><a href="#cb115-31" tabindex="-1"></a>    logyhat3[<span class="dv">2</span>]<span class="ot">&lt;-</span>J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[j]</span>
<span id="cb115-32"><a href="#cb115-32" tabindex="-1"></a>    yhat3<span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat3)</span>
<span id="cb115-33"><a href="#cb115-33" tabindex="-1"></a>    e3[<span class="dv">1</span>,col]<span class="ot">&lt;-</span>magnetic[i]<span class="sc">-</span>yhat3[<span class="dv">1</span>]</span>
<span id="cb115-34"><a href="#cb115-34" tabindex="-1"></a>    e3[<span class="dv">2</span>,col]<span class="ot">&lt;-</span>magnetic[j]<span class="sc">-</span>yhat3[<span class="dv">2</span>]</span>
<span id="cb115-35"><a href="#cb115-35" tabindex="-1"></a>    </span>
<span id="cb115-36"><a href="#cb115-36" tabindex="-1"></a>    <span class="co">#双对数</span></span>
<span id="cb115-37"><a href="#cb115-37" tabindex="-1"></a>    J4<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span><span class="fu">log</span>(x))</span>
<span id="cb115-38"><a href="#cb115-38" tabindex="-1"></a>    logyhat4[<span class="dv">1</span>]<span class="ot">&lt;-</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[i])</span>
<span id="cb115-39"><a href="#cb115-39" tabindex="-1"></a>    logyhat4[<span class="dv">2</span>]<span class="ot">&lt;-</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[j])</span>
<span id="cb115-40"><a href="#cb115-40" tabindex="-1"></a>    yhat4<span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat4)</span>
<span id="cb115-41"><a href="#cb115-41" tabindex="-1"></a>    e4[<span class="dv">1</span>,col]<span class="ot">&lt;-</span>magnetic[i]<span class="sc">-</span>yhat4[<span class="dv">1</span>]</span>
<span id="cb115-42"><a href="#cb115-42" tabindex="-1"></a>    e4[<span class="dv">2</span>,col]<span class="ot">&lt;-</span>magnetic[j]<span class="sc">-</span>yhat4[<span class="dv">2</span>]</span>
<span id="cb115-43"><a href="#cb115-43" tabindex="-1"></a>  }</span>
<span id="cb115-44"><a href="#cb115-44" tabindex="-1"></a>}</span>
<span id="cb115-45"><a href="#cb115-45" tabindex="-1"></a></span>
<span id="cb115-46"><a href="#cb115-46" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>根据预测误差标准，模型2（二次模型）可能最适合该数据</p>
</div>
<div id="模型2的拟合回归方程" class="section level3">
<h3>模型2的拟合回归方程</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>y<span class="ot">&lt;-</span>magnetic</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>x<span class="ot">&lt;-</span>chemical</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    24.49262     -1.39334      0.05452</code></pre>
<p>即回归方程为<span class="math inline">\(\hat{Y}=24.49262-1.39334X+0.05452X^2\)</span></p>
</div>
</div>
<div id="hw6-2023-10-30" class="section level1">
<h1>HW6 2023-10-30</h1>
</div>
<div id="question1-2" class="section level1">
<h1>Question1</h1>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-16" class="section level1">
<h1>Answer</h1>
</div>
<div id="question2-2" class="section level1">
<h1>Question2</h1>
<p>课本练习8.1</p>
</div>
<div id="answer-17" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co">#计算积分二次方距离</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>cvm<span class="ot">&lt;-</span><span class="cf">function</span>(X,Y){</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(X)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">length</span>(Y)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  </span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">sort</span>(X)</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">sort</span>(Y)</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  Fn<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">sum</span>(X<span class="sc">&lt;=</span>x)<span class="sc">/</span>n</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  Gm<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">sum</span>(Y<span class="sc">&lt;=</span>x)<span class="sc">/</span>m</span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  </span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  C<span class="ot">&lt;-</span>m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  sigma1<span class="ot">&lt;-</span><span class="fu">sum</span>((<span class="fu">Fn</span>(X)<span class="sc">-</span><span class="fu">Gm</span>(X))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>  sigma2<span class="ot">&lt;-</span><span class="fu">sum</span>((<span class="fu">Fn</span>(Y)<span class="sc">-</span><span class="fu">Gm</span>(Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>  </span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>  <span class="fu">return</span>(C<span class="sc">*</span>(sigma1<span class="sc">+</span>sigma2))</span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a>}</span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a></span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a><span class="co">#读入数据</span></span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a></span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a><span class="co">#进行置换检验</span></span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb119-26"><a href="#cb119-26" tabindex="-1"></a><span class="fu">options</span>( <span class="at">warn =</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb119-27"><a href="#cb119-27" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>           <span class="co">#重复次数</span></span>
<span id="cb119-28"><a href="#cb119-28" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)       <span class="co">#原始数据</span></span>
<span id="cb119-29"><a href="#cb119-29" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb119-30"><a href="#cb119-30" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#存储重复变量</span></span>
<span id="cb119-31"><a href="#cb119-31" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cvm</span>(x,y)</span>
<span id="cb119-32"><a href="#cb119-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb119-33"><a href="#cb119-33" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-34"><a href="#cb119-34" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb119-35"><a href="#cb119-35" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb119-36"><a href="#cb119-36" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">cvm</span>(x1,y1)</span>
<span id="cb119-37"><a href="#cb119-37" tabindex="-1"></a>}</span>
<span id="cb119-38"><a href="#cb119-38" tabindex="-1"></a></span>
<span id="cb119-39"><a href="#cb119-39" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb119-40"><a href="#cb119-40" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.066</code></pre>
<p>由于p值大于0.05，故无法拒绝原假设，因此认为两组样本服从相同的分布</p>
</div>
<div id="question-3-4" class="section level1">
<h1>Question 3</h1>
<p>课本习题8.3</p>
</div>
<div id="answer-18" class="section level1">
<h1>Answer</h1>
<div id="编写函数返回端点个数最大值" class="section level3">
<h3>编写函数返回端点个数最大值</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>counttest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy))) <span class="co">#返回端点个数最大值</span></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="利用端点个数最大值编写进行置换检验的函数" class="section level3">
<h3>利用端点个数最大值编写进行置换检验的函数</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>permutation.counttest<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>           <span class="co">#重复次数</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)       <span class="co">#原始数据</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>(m<span class="sc">+</span>n)</span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#存储重复变量</span></span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">counttest</span>(x,y)</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">counttest</span>(x1,y1)</span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a>}</span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a>p</span>
<span id="cb122-19"><a href="#cb122-19" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="双样本分布相同时的情形" class="section level3">
<h3>双样本分布相同时的情形</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a><span class="fu">permutation.counttest</span>(x1,y1)</span></code></pre></div>
<pre><code>## [1] 0.888</code></pre>
<p>p&gt;&gt;0.05,故接受原假设，认为x1与y1服从相同的分布</p>
</div>
<div id="双样本分布不同时的情形" class="section level3">
<h3>双样本分布不同时的情形</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="fl">1.5</span>)</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a><span class="fu">permutation.counttest</span>(x2,y2)</span></code></pre></div>
<pre><code>## [1] 0.005</code></pre>
<p>p&lt;&lt;0.05,故拒绝原假设，认为x2与y2服从不同的分布</p>
</div>
</div>
<div id="hw7-2023-11-06" class="section level1">
<h1>HW7 2023-11-06</h1>
</div>
<div id="question-1-4" class="section level1">
<h1>Question 1</h1>
<p>Consider a model</p>
<div id="question-1.1" class="section level3">
<h3>Question 1.1</h3>
<p>Design a function that takes as input values N, b1, b2, b3 and f0,
and produces the output a.</p>
</div>
<div id="answer-1.1" class="section level3">
<h3>Answer 1.1</h3>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>alpha.determination<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>  X1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="at">lambda=</span><span class="dv">1</span>)</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>  X2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>  X3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>  </span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>  g<span class="ot">&lt;-</span><span class="cf">function</span>(alpha){</span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>    temp<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>X1<span class="sc">-</span>b2<span class="sc">*</span>X2<span class="sc">-</span>b3<span class="sc">*</span>X3)</span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>    q<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>temp)</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>    <span class="fu">mean</span>(q)<span class="sc">-</span>f0</span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>  }</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>  </span>
<span id="cb127-12"><a href="#cb127-12" tabindex="-1"></a>  solution<span class="ot">&lt;-</span><span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">0</span>))</span>
<span id="cb127-13"><a href="#cb127-13" tabindex="-1"></a>  <span class="fu">unlist</span>(solution)[<span class="dv">1</span>]</span>
<span id="cb127-14"><a href="#cb127-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="question-1.2" class="section level3">
<h3>Question 1.2</h3>
<p>Call this function, input values are N = 10^6 , b1 = 0, b2 = 1, b3 =
−1, f0 = 0.1, 0.01, 0.001, 0.0001.</p>
</div>
<div id="answer-1.2" class="section level3">
<h3>Answer 1.2</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(f0)</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>a.root<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>  a.root[i]<span class="ot">&lt;-</span><span class="fu">alpha.determination</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>}</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a></span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>a.root</span></code></pre></div>
<pre><code>## [1]  -3.169259  -6.072560  -8.707825 -11.291724</code></pre>
</div>
<div id="question-1.3" class="section level3">
<h3>Question 1.3</h3>
<p>Plot − log f0 vs a.</p>
</div>
<div id="answer-1.3" class="section level3">
<h3>Answer 1.3</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),a.root)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2-4" class="section level1">
<h1>Question 2</h1>
<p>Exercise 9.4</p>
</div>
<div id="answer-19" class="section level1">
<h1>Answer</h1>
<div id="下面的函数用来计算拉普拉斯分布的密度" class="section level3">
<h3>下面的函数用来计算拉普拉斯分布的密度</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="使用正态建议分布生成拉普拉斯分布样本" class="section level3">
<h3>使用正态建议分布生成拉普拉斯分布样本</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>mh<span class="ot">&lt;-</span><span class="cf">function</span>(sd){</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>  xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>xt,<span class="at">sd=</span>sd)</span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,<span class="at">mean=</span>y,<span class="at">sd=</span>sd)</span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>  den<span class="ot">&lt;-</span><span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span>xt,<span class="at">sd=</span>sd)</span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>  <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>num<span class="sc">/</span>den){</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a>  }</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span>    <span class="co">#被拒绝的y的个数</span></span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a>  }</span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a>}</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a></span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a>out<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="at">rate=</span><span class="dv">1</span><span class="sc">-</span>k<span class="sc">/</span>m,<span class="at">chain=</span>x)</span>
<span id="cb132-24"><a href="#cb132-24" tabindex="-1"></a><span class="fu">return</span>(out)</span>
<span id="cb132-25"><a href="#cb132-25" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>mh1<span class="ot">&lt;-</span><span class="fu">mh</span>(<span class="fl">0.5</span>)</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>mh2<span class="ot">&lt;-</span><span class="fu">mh</span>(<span class="dv">1</span>)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>mh3<span class="ot">&lt;-</span><span class="fu">mh</span>(<span class="dv">2</span>)</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>x1<span class="ot">&lt;-</span>mh1<span class="sc">$</span>chain</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>x2<span class="ot">&lt;-</span>mh2<span class="sc">$</span>chain</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>x3<span class="ot">&lt;-</span>mh3<span class="sc">$</span>chain</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="dv">6000</span><span class="sc">:</span><span class="dv">6500</span></span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a></span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>y1<span class="ot">&lt;-</span>x1[index]</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a>y2<span class="ot">&lt;-</span>x2[index]</span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>y3<span class="ot">&lt;-</span>x3[index]</span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" tabindex="-1"></a><span class="fu">plot</span>(index,y1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">plot</span>(index,y2,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">plot</span>(index,y3,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">c</span>(mh1<span class="sc">$</span>rate,mh2<span class="sc">$</span>rate,mh3<span class="sc">$</span>rate)</span></code></pre></div>
<pre><code>## [1] 0.8217 0.6946 0.5340</code></pre>
<p>从结果可以看出，方差越小，链条的接受率越大</p>
</div>
</div>
<div id="question-3-5" class="section level1">
<h1>Question 3</h1>
<p>习题9.7</p>
</div>
<div id="answer-20" class="section level1">
<h1>Answer</h1>
<div id="生成样本" class="section level3">
<h3>生成样本</h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>                <span class="co">#链条长度</span></span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>             <span class="co">#链条要去掉前1000个数</span></span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)     <span class="co">#链条（二维变量）</span></span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#相关系数</span></span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a></span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a><span class="co">#生成链条</span></span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#初始化</span></span>
<span id="cb138-17"><a href="#cb138-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb138-18"><a href="#cb138-18" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb138-19"><a href="#cb138-19" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb138-20"><a href="#cb138-20" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb138-21"><a href="#cb138-21" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb138-22"><a href="#cb138-22" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb138-23"><a href="#cb138-23" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb138-24"><a href="#cb138-24" tabindex="-1"></a>}</span>
<span id="cb138-25"><a href="#cb138-25" tabindex="-1"></a></span>
<span id="cb138-26"><a href="#cb138-26" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb138-27"><a href="#cb138-27" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb138-28"><a href="#cb138-28" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 1.000000 0.899046
## [2,] 0.899046 1.000000</code></pre>
</div>
<div id="绘制生成样本的图形" class="section level3">
<h3>绘制生成样本的图形</h3>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="做回归分析" class="section level3">
<h3>做回归分析</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>x_data.frame<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x1=</span>x[,<span class="dv">1</span>],<span class="at">x2=</span>x[,<span class="dv">2</span>])</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(x2<span class="sc">~</span>x1,<span class="at">data=</span>x_data.frame)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x2 ~ x1, data = x_data.frame)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.57177 -0.28998 -0.00101  0.29684  1.70173 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.007056   0.006889  -1.024    0.306    
## x1           0.902345   0.006950 129.830   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4355 on 3998 degrees of freedom
## Multiple R-squared:  0.8083, Adjusted R-squared:  0.8082 
## F-statistic: 1.686e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>即线性回归模型拟合结果为<span class="math inline">\(X2=-0.007056+0.902345X1\)</span></p>
</div>
<div id="残差检验" class="section level3">
<h3>残差检验</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question4" class="section level1">
<h1>Question4</h1>
<p>习题9.10</p>
<div id="计算诊断统计量的函数" class="section level3">
<h3>计算诊断统计量的函数</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="将m-h样本生成器写成函数" class="section level3">
<h3>将M-H样本生成器写成函数</h3>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a><span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>}</span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>chisq.chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,m){ <span class="co">#sigma=4,m=10000</span></span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a></span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb145-13"><a href="#cb145-13" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb145-14"><a href="#cb145-14" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb145-15"><a href="#cb145-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb145-16"><a href="#cb145-16" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb145-17"><a href="#cb145-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb145-18"><a href="#cb145-18" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb145-19"><a href="#cb145-19" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb145-20"><a href="#cb145-20" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb145-21"><a href="#cb145-21" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb145-22"><a href="#cb145-22" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb145-23"><a href="#cb145-23" tabindex="-1"></a>}</span>
<span id="cb145-24"><a href="#cb145-24" tabindex="-1"></a>}</span>
<span id="cb145-25"><a href="#cb145-25" tabindex="-1"></a></span>
<span id="cb145-26"><a href="#cb145-26" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb145-27"><a href="#cb145-27" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="模拟4条链" class="section level3">
<h3>模拟4条链</h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>X[i, ] <span class="ot">&lt;-</span> <span class="fu">chisq.chain</span>(sigma, n)</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb146-16"><a href="#cb146-16" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.117781</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a><span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a><span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmZmZmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC22/+2///bkDrb2//b////tmb/25D/27b//7b//9v////2GmsEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHaElEQVR4nO2diXabRhhGx62TLmntxN2sRo0cm/d/xkqIZdjm/sMiBvPdk8RIDN+ge5gFRLDLRBC39g6kjgQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBwMyC3GZYS9C8ccshQYAEASsLSt/T2oKSNyRBwLqCIkbRtZAg4MaC2vMvCYI4CYI4CYI4CYI4CYI4CYI4CYI4CYI4CYI4CYI4CYK49E/GJAiQIECCAAkCEhCUtiIJAtYXlHgjkyBg9WvSEhSMkyCIkyCIkyCI26mg18f7b7a43Qr69PHBFLdbQQ/Z0X0wxO1YUJadXMBRFZeooGqvFhSU5Y5++BqOS1KQu5UgS1w1qY6oYGH8hi9BPSwuKCouMUHlqWKpSIJ8vBPphQUdz/lf8gXqpGMELe6wISiyzqidO949nzuiyyA/p6DggDeHvEbbis2N2YG3p4f83/MJh1GQM1QQnFN6q8ar6stfaBTLm1d2uP82lyDXI8h/5d0VugFB1yPozOHDwoI6880pgnoP0IX6oELL62NrJt3z37DiBbmitN9fFF4mfUvSu+Fio9i1kb094RFUfVaovv7shaCGaHdVNOXkt3/D9edBRkGuIcj1CPImeGMkDWwTK+jtb7oUFhVXLnZG1075siXWYlxW/swKM4UctD1cQXBHIeD64/Xx7tPnf/4z18uddC0oNMvpCqr/tARB1GANA++bA4qf3//65Vz/79E7MFxv/slbPXersKsE5UJc01HZrLxePFrQcN3mBP/F9z/wdN0eV304gyBXHjGlBK/f8a7hRAsa3mBkJ/3y68SuaJqgrCHI9QiKMhQqH98HVTOZgd4lKq5YZEGZ6yxV6+qWVZdfTVDBrY+gumzbhredVyxakGVHIcR/8XYI9kHeYYbXpOtJ8rChpqDWe/XUuVEs/AGa6SEJI0ex38IH0OAEuq9eEuS/7wky55cpg0XDE7BwPZ2C13nQv1T67Sn4rdhoQdlYQUOHCc9Qw/V0Clpn0qfiZMxQ7zhBQI8gQ7ghaHrB6LhyiO45Q6inOvVbYwX1foLQ0NAfNL1gdNwtBDkJGs4vX/ZtyVePNifIuCNeV1797Rn6OWwbgkbm11fZXFVRo1B6guoJpJ/swoLGVVTWVpzcZr2CDEHmGuN2MCIuJMhlY2suBbXP/P3qLcnpCxpZcVNQkeadwLV2wrKjMxWMjisvC/Yc8kOjs60CV19kK9Oah9J2BA11x1MFFfGVIL9rMs4YkhJknt+ZKigbVkNEOUSYO7ekBbmZBLUi/clRzI7OVDA6zv8Erl1ouqCsX5C1+09VkKuOrLGChq++tbomyDFXaC0YHXdjQfX6LQsqZ0ZTBNF6W3Cagtx0QbidMTc1QfWc1z+LWoItC3K3EGREgoAUBTkJCgpyEpRJUEycPyMpBWV7FdR7yVWCwnEDgqrrXeuSnCDXErQ2iQnKPEHrN68LSQoqrkWk4CdJQWWB9y/o5ePgPTBNJ40XrqfMeiwiKPIWPNdcsQNB2cnl9zCOOIL8BveOBRWPN7EJyvYoKMsOd88SFOToHiYKSoIFR7GXjz9KUJC3p+FbXSUoIm6PgiKevNBekZafhQTFPHmhvWIPgqKevNBesQdBUU9eaK/Yg6CoJy9MqOcWLNQHRTx5YUo9N2CxUcz+5IUp9SxPCvOgpJEgYGlB0Z10augIAlYTtBlWEhQM7X97hsJz1DeEBAESBMz8tU8w9N0LMjx5IRj6/gXxkxeCoTsQhE9eCIbuQdCkUAmCUAl6j0gQIEGABAESBEgQIEGABAESBEgQIEGABAESBMwv6OTc3XO4yCH/ZZJVwe5CiJefv/ZvFBdjZXZBp/O+ncL7d3IXQVXB7kKI18f8sm9ga1OMmbkFXe8hOoSuzL4+XgRVBbsLIYrfHhjY2hRjZ25B15vMh766zzne/3kWVBXsLgTiT+7hdCkQ2NoSE8Hsgn66HNunwO6dS1z6oKpgdyFcw1XQ8NbGGCtzC7o2/kAXcGkBF0FVwe4C1HD56IGtjTFWbi7oeJazZ0F0gOfr99zEqIs8Fl9dfxndu268kzYNsofxw3whaLvDvGmadpgwUSwaz2Yninkjsp1qVAW7CyGK3iWwtSnGik5WAQkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAjYgKDivt+VSF9Qcd/vWiQv6ATPCVma1AWV9/2uRuqCshlvNxyFBAESBEgQIEGABAESBEgQsAFB6yJBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgT8D0dXMzVfY1yIAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw8-2023-11-13" class="section level1">
<h1>HW8 2023-11-13</h1>
</div>
<div id="question-1-5" class="section level1">
<h1>Question 1</h1>
<p>求区间删失数据的MLE，证明EM算法收敛于MLE且有线性速度</p>
</div>
<div id="answer-21" class="section level1">
<h1>Answer</h1>
<div id="第1问" class="section level2">
<h2>第1问</h2>
</div>
<div id="第2问" class="section level2">
<h2>第2问</h2>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a>  v<span class="ot">&lt;-</span>u<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb150-4"><a href="#cb150-4" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>v<span class="sc">*</span>x)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">*</span>x))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">*</span>x)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>v<span class="sc">*</span>x)))</span>
<span id="cb150-6"><a href="#cb150-6" tabindex="-1"></a>}</span></code></pre></div>
<div id="求lambda的极大似然估计" class="section level3">
<h3>求lambda的极大似然估计</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="fu">uniroot</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>),<span class="at">tol=</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## $root
## [1] 0.07197378
## 
## $f.root
## [1] -0.000550488
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 5e-06</code></pre>
<p>即lambda的极大似然估计为0.07197</p>
</div>
<div id="用em算法估计lambda" class="section level3">
<h3>用EM算法估计lambda</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>                      <span class="co">#误差</span></span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>lambda0<span class="ot">&lt;-</span>lambda1<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>temp<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>iter<span class="ot">&lt;-</span><span class="dv">0</span>                         <span class="co">#计数器</span></span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(temp<span class="sc">-</span>lambda1)<span class="sc">&gt;</span>est){</span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a>  lambda1<span class="ot">&lt;-</span>n<span class="sc">/</span>(n<span class="sc">/</span>lambda0<span class="sc">-</span><span class="fu">f</span>(lambda0))</span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a>  temp<span class="ot">&lt;-</span>lambda0</span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a>  lambda0<span class="ot">&lt;-</span>lambda1</span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a>  iter<span class="ot">&lt;-</span>iter<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a>}</span>
<span id="cb153-13"><a href="#cb153-13" tabindex="-1"></a></span>
<span id="cb153-14"><a href="#cb153-14" tabindex="-1"></a>lambda0</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>iter</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>即EM算法对lambda的估计值为0.07197,可以看到该值与MLE十分接近</p>
</div>
</div>
</div>
<div id="question-2-5" class="section level1">
<h1>Question 2</h1>
<p>习题11.8</p>
</div>
<div id="answer-22" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb157-3"><a href="#cb157-3" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb157-4"><a href="#cb157-4" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb157-5"><a href="#cb157-5" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb157-6"><a href="#cb157-6" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb157-7"><a href="#cb157-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb157-8"><a href="#cb157-8" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb157-9"><a href="#cb157-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb157-10"><a href="#cb157-10" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb157-11"><a href="#cb157-11" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb157-12"><a href="#cb157-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb157-13"><a href="#cb157-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb157-14"><a href="#cb157-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb157-15"><a href="#cb157-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb157-16"><a href="#cb157-16" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb157-17"><a href="#cb157-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb157-18"><a href="#cb157-18" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb157-19"><a href="#cb157-19" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb157-20"><a href="#cb157-20" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb157-21"><a href="#cb157-21" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb157-22"><a href="#cb157-22" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb157-23"><a href="#cb157-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb157-24"><a href="#cb157-24" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb157-25"><a href="#cb157-25" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb157-26"><a href="#cb157-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb157-27"><a href="#cb157-27" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb157-28"><a href="#cb157-28" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb157-29"><a href="#cb157-29" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb157-30"><a href="#cb157-30" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb157-31"><a href="#cb157-31" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb157-32"><a href="#cb157-32" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb157-33"><a href="#cb157-33" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb157-34"><a href="#cb157-34" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb157-35"><a href="#cb157-35" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb157-36"><a href="#cb157-36" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb157-37"><a href="#cb157-37" tabindex="-1"></a>soln</span>
<span id="cb157-38"><a href="#cb157-38" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="co">#enter the payoff matrix</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb158-7"><a href="#cb158-7" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb158-8"><a href="#cb158-8" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb158-9"><a href="#cb158-9" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb158-10"><a href="#cb158-10" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb158-11"><a href="#cb158-11" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb158-12"><a href="#cb158-12" tabindex="-1"></a>B <span class="ot">&lt;-</span> A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb158-13"><a href="#cb158-13" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<p>即博弈B的解与博弈A相同，是原来博弈A的端点</p>
</div>
<div id="hw9-2023-11-20" class="section level1">
<h1>HW9 2023-11-20</h1>
</div>
<div id="question-1-6" class="section level1">
<h1>Question 1</h1>
<p>2.1.3.4. Why do you need to use unlist() to convert a list to an
atomic vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-23" class="section level1">
<h1>Answer</h1>
<p>R中的vector分为两类，atomic和list，二者的区别在于,前者元素类型必须相同，后者可以不同。前者的代表是向量和矩阵，后者的代表是list和数据框。</p>
<p>由于它们都是vector,所以用is.vector检验无法区分向量和列表。当然，也无法用as.vector将列表转换成向量。所以将list转化成atomic
vector需要借助unlist。</p>
</div>
<div id="question-2-6" class="section level1">
<h1>Question 2</h1>
<p>2.3.1.1. What does dim() return when applied to a vector?</p>
</div>
<div id="answer-24" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a><span class="fu">dim</span>(y)</span></code></pre></div>
<pre><code>## [1] 2 2</code></pre>
<p>dim函数只适用于矩阵和数据框，对于其他类型的变量，比如向量或者列表，dim函数将返回NULL</p>
</div>
<div id="question-3-6" class="section level1">
<h1>Question 3</h1>
<p>2.3.1.2. If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="answer-25" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>is.array(x)会返回TRUE</p>
</div>
<div id="question-4-2" class="section level1">
<h1>Question 4</h1>
<p>2.4.5.2. What does as.matrix() do when applied to a data frame with
columns of different types?</p>
</div>
<div id="answer-26" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##      X1.4 letters.1.4.
## [1,] &quot;1&quot;  &quot;a&quot;         
## [2,] &quot;2&quot;  &quot;b&quot;         
## [3,] &quot;3&quot;  &quot;c&quot;         
## [4,] &quot;4&quot;  &quot;d&quot;</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a><span class="fu">is.data.frame</span>(x)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>as.matrix将list转化为matrix,并且当其中的元素类型不同时,所有元素将被强制转化为最灵活的类型</p>
</div>
<div id="question-5-1" class="section level1">
<h1>Question 5</h1>
<p>2.4.5.3. Can you have a data frame with 0 rows? What about 0
columns?</p>
</div>
<div id="answer-27" class="section level1">
<h1>Answer</h1>
<p>数据框可以有0行，当数据框的每一列都是长度为0的向量时，数据框的行数为0</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>test<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">character</span>(<span class="dv">0</span>),<span class="at">col2=</span><span class="fu">numeric</span>(<span class="dv">0</span>),<span class="at">col3=</span><span class="fu">logical</span>(<span class="dv">0</span>))</span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a><span class="fu">str</span>(test)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  3 variables:
##  $ col1: chr 
##  $ col2: num 
##  $ col3: logi</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>## [1] col1 col2 col3
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>数据框的列数不能为0，否则数据框中没有向量</p>
</div>
<div id="question-6-1" class="section level1">
<h1>Question 6</h1>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co">#获取一个长为2的向量，储存x的最小值和最大值</span></span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])  <span class="co">#将x的每个元素映射到[0,1]上</span></span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="answer-28" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">c</span>(F,F,F,T,T),<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)  <span class="co">#构造一个数据框</span></span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="co">#将scale01运用到数据框每一列</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a><span class="fu">lapply</span>(data,scale01)</span></code></pre></div>
<pre><code>## $X1.5
## [1] 0.00 0.25 0.50 0.75 1.00
## 
## $c.F..F..F..T..T.
## [1] 0 0 0 1 1
## 
## $X2.6
## [1] 0.00 0.25 0.50 0.75 1.00</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a><span class="co">#将scale01运用到数据框每一numeric列</span></span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a><span class="fu">lapply</span>(data[<span class="fu">lapply</span>(data,is.numeric)<span class="sc">==</span>T],scale01)</span></code></pre></div>
<pre><code>## $X1.5
## [1] 0.00 0.25 0.50 0.75 1.00
## 
## $X2.6
## [1] 0.00 0.25 0.50 0.75 1.00</code></pre>
</div>
<div id="question-7" class="section level1">
<h1>Question 7</h1>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol>
</div>
<div id="answer-29" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="co">#数据框全是numeric型元素</span></span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)  <span class="co">#构造一个纯数值数据框</span></span>
<span id="cb187-3"><a href="#cb187-3" tabindex="-1"></a><span class="fu">vapply</span>(data1,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     X1.5     X2.6 
## 1.581139 1.581139</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="co">#数据框是混合型元素</span></span>
<span id="cb189-2"><a href="#cb189-2" tabindex="-1"></a>data2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)  <span class="co">#构造一个混合型数据框</span></span>
<span id="cb189-3"><a href="#cb189-3" tabindex="-1"></a><span class="fu">vapply</span>(data2[<span class="fu">vapply</span>(data,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))<span class="sc">==</span>T],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     X1.5     X2.6 
## 1.581139 1.581139</code></pre>
</div>
<div id="question-8" class="section level1">
<h1>Question 8</h1>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section) • Write an R
function. • Write an Rcpp function. • Compare the computation time of
the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-30" class="section level1">
<h1>Answer</h1>
<div id="r代码" class="section level3">
<h3>R代码</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span>     <span class="co">#x的初始值</span></span>
<span id="cb191-8"><a href="#cb191-8" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fl">0.5</span>   <span class="co">#y的初始值</span></span>
<span id="cb191-9"><a href="#cb191-9" tabindex="-1"></a></span>
<span id="cb191-10"><a href="#cb191-10" tabindex="-1"></a><span class="do">###### 生成链 #####</span></span>
<span id="cb191-11"><a href="#cb191-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb191-12"><a href="#cb191-12" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#初始化</span></span>
<span id="cb191-13"><a href="#cb191-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb191-14"><a href="#cb191-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb191-15"><a href="#cb191-15" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb191-16"><a href="#cb191-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb191-17"><a href="#cb191-17" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb191-18"><a href="#cb191-18" tabindex="-1"></a>}</span>
<span id="cb191-19"><a href="#cb191-19" tabindex="-1"></a></span>
<span id="cb191-20"><a href="#cb191-20" tabindex="-1"></a>d <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb191-21"><a href="#cb191-21" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> X[d<span class="sc">:</span>N, ]</span>
<span id="cb191-22"><a href="#cb191-22" tabindex="-1"></a></span>
<span id="cb191-23"><a href="#cb191-23" tabindex="-1"></a><span class="fu">plot</span>(x0)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rcpp代码" class="section level3">
<h3>Rcpp代码</h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb192-2"><a href="#cb192-2" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39;</span></span>
<span id="cb192-4"><a href="#cb192-4" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb192-5"><a href="#cb192-5" tabindex="-1"></a><span class="st">#include &lt;iostream&gt;</span></span>
<span id="cb192-6"><a href="#cb192-6" tabindex="-1"></a><span class="st">#include &lt;ctime&gt;</span></span>
<span id="cb192-7"><a href="#cb192-7" tabindex="-1"></a><span class="st">#include &lt;random&gt;</span></span>
<span id="cb192-8"><a href="#cb192-8" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb192-9"><a href="#cb192-9" tabindex="-1"></a></span>
<span id="cb192-10"><a href="#cb192-10" tabindex="-1"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb192-11"><a href="#cb192-11" tabindex="-1"></a><span class="st">long cls_random::randomBinomial(long N,double probability){</span></span>
<span id="cb192-12"><a href="#cb192-12" tabindex="-1"></a><span class="st">    long rnd = 0;</span></span>
<span id="cb192-13"><a href="#cb192-13" tabindex="-1"></a><span class="st">    for (long i=0;i&lt;N;i++){</span></span>
<span id="cb192-14"><a href="#cb192-14" tabindex="-1"></a><span class="st">        double pV = (double)rand()/(double)RAND_MAX;</span></span>
<span id="cb192-15"><a href="#cb192-15" tabindex="-1"></a><span class="st">        if (pV&lt;probability){</span></span>
<span id="cb192-16"><a href="#cb192-16" tabindex="-1"></a><span class="st">            rnd++;</span></span>
<span id="cb192-17"><a href="#cb192-17" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb192-18"><a href="#cb192-18" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb192-19"><a href="#cb192-19" tabindex="-1"></a><span class="st">  return rnd;</span></span>
<span id="cb192-20"><a href="#cb192-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb192-21"><a href="#cb192-21" tabindex="-1"></a></span>
<span id="cb192-22"><a href="#cb192-22" tabindex="-1"></a><span class="st">double cls_random::randomBeta(double alpha,double beta){</span></span>
<span id="cb192-23"><a href="#cb192-23" tabindex="-1"></a><span class="st">    double u, v;</span></span>
<span id="cb192-24"><a href="#cb192-24" tabindex="-1"></a><span class="st">    double x, y;</span></span>
<span id="cb192-25"><a href="#cb192-25" tabindex="-1"></a><span class="st">    do </span></span>
<span id="cb192-26"><a href="#cb192-26" tabindex="-1"></a><span class="st">    {</span></span>
<span id="cb192-27"><a href="#cb192-27" tabindex="-1"></a><span class="st">        u=cls_random::randomUniform();</span></span>
<span id="cb192-28"><a href="#cb192-28" tabindex="-1"></a><span class="st">        v=cls_random::randomUniform();</span></span>
<span id="cb192-29"><a href="#cb192-29" tabindex="-1"></a><span class="st">        x=pow(u,1/alpha);</span></span>
<span id="cb192-30"><a href="#cb192-30" tabindex="-1"></a><span class="st">        y=pow(v,1/beta);</span></span>
<span id="cb192-31"><a href="#cb192-31" tabindex="-1"></a><span class="st">    } while (x+y&gt;1);</span></span>
<span id="cb192-32"><a href="#cb192-32" tabindex="-1"></a><span class="st">    return x/(x+y);</span></span>
<span id="cb192-33"><a href="#cb192-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb192-34"><a href="#cb192-34" tabindex="-1"></a></span>
<span id="cb192-35"><a href="#cb192-35" tabindex="-1"></a><span class="st">  NumericVector iters(int a,int b,int n,int x,int y){</span></span>
<span id="cb192-36"><a href="#cb192-36" tabindex="-1"></a><span class="st">    int N=5000;</span></span>
<span id="cb192-37"><a href="#cb192-37" tabindex="-1"></a><span class="st">    int X[N][2];</span></span>
<span id="cb192-38"><a href="#cb192-38" tabindex="-1"></a><span class="st">    int x1;</span></span>
<span id="cb192-39"><a href="#cb192-39" tabindex="-1"></a><span class="st">    int y1;</span></span>
<span id="cb192-40"><a href="#cb192-40" tabindex="-1"></a></span>
<span id="cb192-41"><a href="#cb192-41" tabindex="-1"></a><span class="st">    X[0][0]=x;</span></span>
<span id="cb192-42"><a href="#cb192-42" tabindex="-1"></a><span class="st">    X[0][1]=y;</span></span>
<span id="cb192-43"><a href="#cb192-43" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb192-44"><a href="#cb192-44" tabindex="-1"></a><span class="st">    for(int i=1;i&lt;N;i++) {</span></span>
<span id="cb192-45"><a href="#cb192-45" tabindex="-1"></a><span class="st">    y1=X[i-1][1];</span></span>
<span id="cb192-46"><a href="#cb192-46" tabindex="-1"></a><span class="st">    X[i][0]=cls_random::randomBinomial(n,y);</span></span>
<span id="cb192-47"><a href="#cb192-47" tabindex="-1"></a><span class="st">    x1=X[i][0];</span></span>
<span id="cb192-48"><a href="#cb192-48" tabindex="-1"></a><span class="st">    X[i][1]=cls_random::randomBeta(x+a,n-x+b);</span></span>
<span id="cb192-49"><a href="#cb192-49" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb192-50"><a href="#cb192-50" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb192-51"><a href="#cb192-51" tabindex="-1"></a><span class="st">    return X;</span></span>
<span id="cb192-52"><a href="#cb192-52" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb192-53"><a href="#cb192-53" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb192-54"><a href="#cb192-54" tabindex="-1"></a></span>
<span id="cb192-55"><a href="#cb192-55" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">iters</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">100</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb192-56"><a href="#cb192-56" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> X[<span class="dv">1001</span><span class="sc">:</span><span class="dv">10000</span>, ]</span>
<span id="cb192-57"><a href="#cb192-57" tabindex="-1"></a><span class="fu">plot</span>(x0)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
